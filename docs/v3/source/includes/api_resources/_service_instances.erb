<% content_for :service_instance_shared_space_relationships do %>
{
  "data": [
    {
      "guid": "68d54d31-9b3a-463b-ba94-e8e4c32edbac"
    },
    {
      "guid": "b19f6525-cbd3-4155-b156-dc0c2a431b4c"
    }
  ],
  "links": {
    "self": {
      "href": "https://api.example.org/v3/service_instances/bdeg4371-cbd3-4155-b156-dc0c2a431b4c/relationships/shared_spaces"
    }
  }
}
<% end %>

<% content_for :paginated_list_of_service_instances do | metadata={} | %>
{
  "pagination": {
    "total_results": 2,
    "total_pages": 1,
    "first": {
      "href": "https://api.example.org/v3/service_instances?page=1&per_page=50"
    },
    "last": {
      "href": "https://api.example.org/v3/service_instances?page=1&per_page=50"
    },
    "next": null,
    "previous": null
  },
  "resources": [
    {
      "guid": "c89b3280-fe8d-4aa0-a42e-44465bb1c61c",
      "created_at": "2020-03-10T15:49:29Z",
      "updated_at": "2020-03-10T15:49:29Z",
      "name": "my-managed-instance",
      "tags": [],
      "type": "managed",
      "maintenance_info": {
        "version": "1.0.0"
      },
      "upgrade_available": false,
      "dashboard_url": "https://service-broker.example.org/dashboard",
      "last_operation": {
        "type": "create",
        "state": "succeeded",
        "description": "Operation succeeded",
        "updated_at": "2020-03-10T15:49:32Z",
        "created_at": "2020-03-10T15:49:29Z"
      },
      "relationships": {
        "service_plan": {
          "data": {
            "guid": "5358d122-638e-11ea-afca-bf6e756684ac"
          }
        },
        "space": {
          "data": {
            "guid": "5a84d315-9513-4d74-95e5-f6a5501eeef7"
          }
        }
      },
      "metadata": {
        "labels": {},
        "annotations": {}
      },
      "links": {
        "self": {
          "href": "https://api.example.org/v3/service_instances/c89b3280-fe8d-4aa0-a42e-44465bb1c61c"
        },
        "service_plan": {
          "href": "https://api.example.org/v3/service_plans/5358d122-638e-11ea-afca-bf6e756684ac"
        },
        "space": {
          "href": "https://api.example.org/v3/spaces/5a84d315-9513-4d74-95e5-f6a5501eeef7"
        },
        "parameters": {
          "href": "https://api.example.org/v3/service_instances/c89b3280-fe8d-4aa0-a42e-44465bb1c61c/parameters"
        },
        "shared_spaces": {
          "href": "https://api.example.org/v3/service_instances/c89b3280-fe8d-4aa0-a42e-44465bb1c61c/relationships/shared_spaces"
        },
        "service_credential_bindings": {
          "href": "https://api.example.org/v3/service_credential_bindings?service_instance_guids=c89b3280-fe8d-4aa0-a42e-44465bb1c61c"
        },
        "service_route_bindings": {
          "href": "https://api.example.org/v3/service_route_bindings?service_instance_guids=c89b3280-fe8d-4aa0-a42e-44465bb1c61c"
        }
      }
    },
    {
      "guid": "88ce23e5-27c3-4381-a2df-32a28ec43133",
      "created_at": "2020-03-10T15:56:08Z",
      "updated_at": "2020-03-10T15:56:08Z",
      "name": "my-user-provided-instance",
      "tags": ["sql"],
      "type": "user-provided",
      "syslog_drain_url": "http://logs.com",
      "route_service_url": "https://routes.com",
      "last_operation": {
        "type": "update",
        "state": "succeeded",
        "description": "Operation succeeded",
        "updated_at": "2020-03-10T15:59:32Z",
        "created_at": "2020-03-10T15:59:29Z"
      },
      "relationships": {
        "space": {
          "data": {
           "guid": "5a84d315-9513-4d74-95e5-f6a5501eeef7"
          }
        }
      },
      "metadata": {
        "labels": {},
        "annotations": {}
      },
      "links": {
        "self": {
          "href": "https://api.example.org/v3/service_instances/88ce23e5-27c3-4381-a2df-32a28ec43133"
        },
        "space": {
          "href": "https://api.example.org/v3/spaces/5a84d315-9513-4d74-95e5-f6a5501eeef7"
        },
        "credentials": {
          "href": "https://api.example.org/v3/service_instances/88ce23e5-27c3-4381-a2df-32a28ec43133/credentials"
        },
        "service_credential_bindings": {
          "href": "https://api.example.org/v3/service_credential_bindings?service_instance_guids=88ce23e5-27c3-4381-a2df-32a28ec43133"
        },
        "service_route_bindings": {
          "href": "https://api.example.org/v3/service_route_bindings?service_instance_guids=88ce23e5-27c3-4381-a2df-32a28ec43133"
        }
      }
    }
  ]
}
<% end %>

<% content_for :single_managed_service_instance do | metadata={} | %>
{
  "guid": "c89b3280-fe8d-4aa0-a42e-44465bb1c61c",
  "created_at": "2020-03-10T15:49:29Z",
  "updated_at": "2020-03-10T15:49:29Z",
  "name": "my-managed-instance",
  "tags": [],
  "type": "managed",
  "maintenance_info": {
    "version": "1.0.0"
  },
  "upgrade_available": false,
  "dashboard_url": "https://service-broker.example.org/dashboard",
  "last_operation": {
    "type": <%= metadata.fetch(:operation, "create").to_json %>,
    "state": "succeeded",
    "description": "Operation succeeded",
    "updated_at": "2020-03-10T15:49:32Z",
    "created_at": "2020-03-10T15:49:29Z"
  },
  "relationships": {
    "service_plan": {
      "data": {
        "guid": "5358d122-638e-11ea-afca-bf6e756684ac"
      }
    },
    "space": {
      "data": {
        "guid": "5a84d315-9513-4d74-95e5-f6a5501eeef7"
      }
    }
  },
  "metadata": {
    "labels": <%= metadata.fetch(:labels, {}).to_json(space: ' ')%>,
    "annotations": <%= metadata.fetch(:annotations, {}).to_json(space: ' ')%>
  },
  "links": {
    "self": {
      "href": "https://api.example.org/v3/service_instances/c89b3280-fe8d-4aa0-a42e-44465bb1c61c"
    },
    "service_plan": {
      "href": "https://api.example.org/v3/service_plans/5358d122-638e-11ea-afca-bf6e756684ac"
    },
    "space": {
      "href": "https://api.example.org/v3/spaces/5a84d315-9513-4d74-95e5-f6a5501eeef7"
    },
    "parameters": {
      "href": "https://api.example.org/v3/service_instances/c89b3280-fe8d-4aa0-a42e-44465bb1c61c/parameters"
    },
    "shared_spaces": {
      "href": "https://api.example.org/v3/service_instances/c89b3280-fe8d-4aa0-a42e-44465bb1c61c/relationships/shared_spaces"
    },
    "service_credential_bindings": {
      "href": "https://api.example.org/v3/service_credential_bindings?service_instance_guids=c89b3280-fe8d-4aa0-a42e-44465bb1c61c"
    },
    "service_route_bindings": {
      "href": "https://api.example.org/v3/service_route_bindings?service_instance_guids=c89b3280-fe8d-4aa0-a42e-44465bb1c61c"
    }
  }
}
<% end %>

<% content_for :single_user_provided_service_instance do | metadata={} | %>
{
  "guid": "88ce23e5-27c3-4381-a2df-32a28ec43133",
  "created_at": "2020-03-10T15:56:08Z",
  "updated_at": "2020-03-10T15:56:08Z",
  "last_operation": {
    "type": <%= metadata.fetch(:operation, "create").to_json %>,
    "state": "succeeded",
    "description": "Operation succeeded",
    "updated_at": "2020-03-10T15:49:32Z",
    "created_at": "2020-03-10T15:49:29Z"
  },
  "name": "my-user-provided-instance",
  "tags": ["sql"],
  "type": "user-provided",
  "syslog_drain_url": "http://logs.com",
  "route_service_url": "https://routes.com",
  "relationships": {
    "space": {
      "data": {
        "guid": "5a84d315-9513-4d74-95e5-f6a5501eeef7"
      }
    }
  },
  "metadata": {
    "labels": <%= metadata.fetch(:labels, {}).to_json(space: ' ')%>,
    "annotations": <%= metadata.fetch(:annotations, {}).to_json(space: ' ')%>
  },
  "links": {
    "self": {
      "href": "https://api.example.org/v3/service_instances/88ce23e5-27c3-4381-a2df-32a28ec43133"
    },
    "space": {
      "href": "https://api.example.org/v3/spaces/5a84d315-9513-4d74-95e5-f6a5501eeef7"
    },
    "credentials": {
      "href": "https://api.example.org/v3/service_instances/88ce23e5-27c3-4381-a2df-32a28ec43133/credentials"
    },
    "service_credential_bindings": {
      "href": "https://api.example.org/v3/service_credential_bindings?service_instance_guids=88ce23e5-27c3-4381-a2df-32a28ec43133"
    },
    "service_route_bindings": {
      "href": "https://api.example.org/v3/service_route_bindings?service_instance_guids=88ce23e5-27c3-4381-a2df-32a28ec43133"
    }
  }
}
<% end %>

<% content_for :user_provided_service_instance_credentials do %>
{
  "username": "my-username",
  "password": "super-secret",
  "other": "credential"
}
<% end %>

<% content_for :managed_service_instance_parameters do %>
{
  "key_1": "value_1",
  "key_2": "value_2"
}
<% end %>

<% content_for :shared_spaces_usage_summary do %>
{
  "usage_summary": [
    {
      "space": {
        "guid": "68d54d31-9b3a-463b-ba94-e8e4c32edbac"
      },
      "bound_app_count": 2
    },
    {
      "space": {
        "guid": "b19f6525-cbd3-4155-b156-dc0c2a431b4c"
      },
      "bound_app_count": 0
    }
  ],
  "links": {
    "self": {
      "href": "https://api.example.org/v3/service_instances/bdeg4371-cbd3-4155-b156-dc0c2a431b4c/relationships/shared_spaces/usage_summary"
    },
    "shared_spaces": {
      "href": "https://api.example.org/v3/service_instances/bdeg4371-cbd3-4155-b156-dc0c2a431b4c/relationships/shared_spaces"
    },
    "service_instance": {
      "href": "https://api.example.org/v3/service_instances/bdeg4371-cbd3-4155-b156-dc0c2a431b4c"
    }
  }
}
<% end %>
